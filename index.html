<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Grammar Arena</title>

<style>
:root{
  --blue:#3b82f6;
  --green:#22c55e;
  --pink:#ec4899;
  --orange:#fb923c;
  --purple:#a855f7;
  --yellow:#facc15;
  --teal:#14b8a6;
  --bg:#f8fafc;
  --dark:#0f172a;
  --white:#ffffff;
}

/* RESET */
*{box-sizing:border-box;margin:0;padding:0}

body{
  font-family:system-ui;
  background:var(--bg);
  color:var(--dark);
  font-size:clamp(16px,2.5vw,20px);
}

/* ---------- SCREENS ---------- */
.screen{
  min-height:100svh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:16px;
}
.hidden{display:none}

/* ---------- START SCREEN ---------- */
.start-card{
  background:var(--white);
  width:100%;
  max-width:520px;
  padding:clamp(18px,4vw,32px);
  border-radius:24px;
  display:flex;
  flex-direction:column;
  gap:clamp(14px,3vw,22px);
}

.start-title{
  text-align:center;
  font-size:clamp(1.6rem,6vw,2.2rem);
  font-weight:900;
  color:var(--purple);
}

.instructions{
  background:var(--yellow);
  border-radius:18px;
  padding:18px;
  font-weight:700;
  line-height:1.4;
}

.instructions ul{
  margin-top:8px;
  padding-left:18px;
}

.name-input{
  width:100%;
  padding:14px;
  border-radius:16px;
  border:3px solid var(--purple);
  font-size:1.05rem;
  font-weight:800;
}

.start-btn{
  width:100%;
  padding:16px;
  border-radius:18px;
  background:var(--purple);
  color:white;
  font-size:1.2rem;
  font-weight:900;
  text-align:center;
  cursor:pointer;
}

/* ---------- GAME ---------- */
.app{
  max-width:1050px;
  width:100%;
  display:flex;
  flex-direction:column;
  gap:18px;
}

.header{
  background:var(--purple);
  color:white;
  padding:18px;
  border-radius:18px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-weight:900;
}

.stats{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(110px,1fr));
  gap:12px;
}

.stat{
  background:var(--white);
  padding:12px;
  border-radius:14px;
  text-align:center;
  font-weight:900;
}

.game{
  background:#e0f2fe;
  padding:22px;
  border-radius:22px;
  display:flex;
  flex-direction:column;
  gap:16px;
}

.sentence{
  background:var(--white);
  border:4px solid var(--yellow);
  border-radius:18px;
  padding:24px;
  font-size:1.6rem;
  font-weight:900;
  text-align:center;
}

/* activity label (informative, not selectable) */
.activity-label{
  align-self:center;
  padding:6px 14px;
  border-radius:14px;
  color:white;
  font-weight:900;
  font-size:0.9rem;
}
.choose{background:var(--blue)}
.order{background:var(--teal)}

.choices{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(120px,1fr));
  gap:14px;
}

.choice{
  padding:18px;
  border-radius:16px;
  font-weight:900;
  color:white;
  text-align:center;
  cursor:pointer;
}
.c1{background:var(--green)}
.c2{background:var(--pink)}
.c3{background:var(--orange)}

.wordbank{
  display:flex;
  gap:10px;
  justify-content:center;
  flex-wrap:wrap;
}

.word{
  background:var(--purple);
  color:white;
  padding:12px 18px;
  border-radius:14px;
  font-weight:900;
  cursor:pointer;
}

.answer{
  min-height:54px;
  background:var(--white);
  border:3px dashed var(--teal);
  border-radius:14px;
  display:flex;
  justify-content:center;
  align-items:center;
  font-weight:900;
}

.check{
  background:var(--teal);
  color:white;
  padding:14px;
  border-radius:16px;
  font-weight:900;
  text-align:center;
  cursor:pointer;
}

.feedback{
  text-align:center;
  font-weight:900;
  font-size:1.2rem;
  padding:10px;
  border-radius:14px;
}
.ok{background:#dcfce7;color:#166534}
.no{background:#fee2e2;color:#991b1b}
</style>
</head>

<body>

<!-- START SCREEN -->
<div class="screen" id="startScreen">
  <div class="start-card">
    <div class="start-title">Grammar Arena</div>

    <div class="instructions">
      <b>How to play:</b>
      <ul>
        <li>Complete the sentence correctly.</li>
        <li>The activity type changes automatically.</li>
        <li>Focus and read carefully.</li>
      </ul>
    </div>

    <input id="playerName" class="name-input" placeholder="Enter your name">

    <div class="start-btn" onclick="startGame()">START GAME</div>
  </div>
</div>

<!-- GAME SCREEN -->
<div class="screen hidden" id="gameScreen">
  <div class="app">

    <div class="header">
      <div>Grammar Arena</div>
      <div id="playerLabel"></div>
    </div>

    <div class="stats">
      <div class="stat">Score<br><span id="score">0</span></div>
      <div class="stat">Streak<br><span id="streak">0</span></div>
      <div class="stat">Mistakes<br><span id="mistakes">0</span></div>
      <div class="stat">Best<br><span id="best">0</span></div>
      <div class="stat">Time<br><span id="time">00:00</span></div>
    </div>

    <div class="game">
      <div class="sentence" id="sentence"></div>
      <div class="activity-label choose" id="activityLabel">CHOOSE</div>

      <div class="choices hidden" id="choices"></div>
      <div class="answer hidden" id="answer"></div>
      <div class="wordbank hidden" id="wordbank"></div>
      <div class="check hidden" id="checkBtn">CHECK</div>

      <div class="feedback hidden" id="feedback"></div>
    </div>

  </div>
</div>

<script>
/* ---------------- DATA ---------------- */
const BANK=[
  {t:"Yesterday, ____ a test.",a:"there was"},
  {t:"Last night, ____ two exams.",a:"there were"},
  {t:"I ____ tired yesterday.",a:"was"},
  {t:"We ____ interested.",a:"were"}
];

/* ---------------- STATE ---------------- */
let score=0,streak=0,best=0,mistakes=0;
let startTime=null;
let current=null;

/* shuffle bank + index */
let bank=[], bankIndex=0;

/* activity shuffle */
let activitySequence=[], activityIndex=0;

/* ---------------- UTILS ---------------- */
function shuffle(arr){
  for(let i=arr.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
  return arr;
}

/* ---------------- INIT ---------------- */
function initGame(){
  bank = shuffle([...BANK]);
  bankIndex = 0;

  activitySequence = shuffle(["choose","order","choose","order"]);
  activityIndex = 0;
}

/* ---------------- START ---------------- */
function startGame(){
  const name=playerName.value.trim();
  if(!name) return alert("Please enter your name");

  playerLabel.textContent=name;
  startScreen.classList.add("hidden");
  gameScreen.classList.remove("hidden");

  startTime=Date.now();
  initGame();
  next();
}

/* ---------------- GAME FLOW ---------------- */
function next(){
  if(bankIndex >= bank.length){
    bank = shuffle([...BANK]);
    bankIndex = 0;
  }
  current = bank[bankIndex++];

  if(activityIndex >= activitySequence.length){
    activitySequence = shuffle(["choose","order","choose","order"]);
    activityIndex = 0;
  }
  const activity = activitySequence[activityIndex++];

  sentence.textContent=current.t;
  feedback.classList.add("hidden");
  answer.textContent="";
  choices.innerHTML="";
  wordbank.innerHTML="";

  activityLabel.textContent = activity.toUpperCase();
  activityLabel.className = "activity-label " + activity;

  activity==="choose" ? renderChoose() : renderOrder();
}

function renderChoose(){
  choices.classList.remove("hidden");
  wordbank.classList.add("hidden");
  answer.classList.add("hidden");
  checkBtn.classList.add("hidden");

  shuffle([current.a,"was","were"]).forEach((o,i)=>{
    const d=document.createElement("div");
    d.className="choice c"+(i+1);
    d.textContent=o;
    d.onclick=()=>check(o);
    choices.appendChild(d);
  });
}

function renderOrder(){
  choices.classList.add("hidden");
  wordbank.classList.remove("hidden");
  answer.classList.remove("hidden");
  checkBtn.classList.remove("hidden");

  shuffle(current.a.split(" ")).forEach(w=>{
    const s=document.createElement("div");
    s.className="word";
    s.textContent=w;
    s.onclick=()=>answer.textContent+=(answer.textContent?" ":"")+w;
    wordbank.appendChild(s);
  });
}

checkBtn.onclick=()=>check(answer.textContent);

function check(val){
  feedback.classList.remove("hidden");
  if(val===current.a){
    score+=10; streak++; best=Math.max(best,streak);
    feedback.textContent="✔ Correct!";
    feedback.className="feedback ok";
  }else{
    streak=0; mistakes++;
    feedback.textContent="✘ Try again";
    feedback.className="feedback no";
  }
  updateStats();
  setTimeout(next,1000);
}

function updateStats(){
  score.textContent=score;
  streak.textContent=streak;
  best.textContent=best;
  mistakes.textContent=mistakes;
}

/* ---------------- TIME ---------------- */
setInterval(()=>{
  if(!startTime) return;
  const s=Math.floor((Date.now()-startTime)/1000);
  time.textContent=
    String(Math.floor(s/60)).padStart(2,"0")+":"+
    String(s%60).padStart(2,"0");
},1000);
</script>

</body>
</html>
